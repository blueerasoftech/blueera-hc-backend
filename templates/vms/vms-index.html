{% extends "partials/base.html" %}
{% load static %}
{% block title %}VMS{% endblock title %}
{% block extra_css %}
{% load tz %}
    <!-- jsvectormap css -->
    <link href="{% static 'libs/jsvectormap/css/jsvectormap.min.css'%}" rel="stylesheet" type="text/css" />

    <!--Swiper slider css-->
    <link href="{% static 'libs/swiper/swiper-bundle.min.css'%}" rel="stylesheet" type="text/css" />

    <style>
        .input-step {
            height: 54px !important;
        }
        .input-step button {
            width: 40px !important;
            font-size: 33px !important;
        }
        .form-control-lg {
            font-size: 24px !important;
            min-height: 50px !important;
        }
    </style>
{% endblock extra_css %}

{% block content %}
        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">
                <div class="container-fluid">
                    
                    {% block pagetitle %}
                    {% include "partials/page-title.html" with pagetitle="Visitor Head Count" title=hcDefault.hc_template.name %}
                    {% endblock pagetitle %}

                    {% block alerts %}
                        {% include "partials/errors.html" with messages=messages %}
                    {% endblock alerts %}

                    <div class="row">
                        <div class="col">

                            <div class="h-100">
                                
                                


                        


                                <div class="row">
                                    <div class="col-7">

                                        <div class="row">
                                            <div class="col-12">
                                                <!-- card -->
                                                <div class="card card-animate">
                                                    <div class="card-body">
                                                        <div class="d-flex align-items-center">
                                                            <div class="flex-grow-1 overflow-hidden">
                                                                <p class="text-uppercase fw-medium text-muted text-truncate mb-0">Headcount</p>
                                                            </div>
        
                                                            <div class="flex-grow-1 overflow-hidden" style="text-align: end;">
                                                                <a href="{% url 'apps.main.vms:vms' template_id=template_id %}" class="text-primary d-inline-block edit-item-btn">
                                                                    <i class="ri-refresh-line fs-24"></i>
                                                                </a>
                                                            </div>
                                                            
                                                        </div>
                                                        <div class="d-flex align-items-end justify-content-between mt-4">
                                                            <div>
                                                                <h4 class="fs-22 fw-semibold ff-secondary mb-4" style="font-size: 40px !important;"><span
                                                                        class="counter-value" data-target="{{ total_count|default:'0' }}">0</span></h4>
                                                                <p class="">Current Visitor Headcount</p>
                                                            </div>
                                                            <div class="avatar-sm flex-shrink-0">
                                                                <span class="avatar-title bg-soft-success rounded fs-3">
                                                                    <i class="ri-group-line text-success"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div><!-- end card body -->
                                                </div><!-- end card -->
                                            </div><!-- end col -->
                                            
                                        </div> <!-- end row-->


                                        {% if configData and configData.is_vms_enabled and configData.is_vms_matrix == False %}

                                            <div class="row">
                                                <div class="col-6">
                                                    <div class="card-animate card">
                                                    <div class="card-body">
                                                            <form method="post" id="in_count" action="{% url 'apps.main.vms:vms-submit' %}">
                                                                <input type="hidden" class="form-control" name="data_type" id="data_type" value="in" placeholder="">
                                                                <input type="hidden" class="form-control" name="template_id" id="template_id" value="{{ template_id }}" placeholder="">
                                                                <input type="hidden" class="form-control" name="visitor_record_id" id="visitor_record_id" value="{{ hcDefault.id }}" placeholder="">
                                                                <div class="d-flex justify-content-between">
                                                                    <div>
                                                                        <p class="fw-medium text-muted mb-0">Visitor In</p>
                                                                        <div class="input-step full-width step-success mt-4"><button type="button" class="minus material-shadow">–</button><input min="1" max="100" readonly="" type="number" name="visitor_count" class="product-quantity form-control form-control-lg" value="1"><button type="button" class="plus material-shadow">+</button></div>
                                                                    </div>
                                                                    <div>
                                                                        <div class="flex-shrink-0">
                                                                        <span class="badge bg-soft-success text-success fs-16"><i class="ri-arrow-up-s-line fs-17 align-middle me-1"></i>IN</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-auto mt-4">
                                                                    <div class="gap-1 flex-wrap">
                                                                        <button type="submit" class="btn btn-success add-btn" data-bs-toggle="modal" id="db_submit_btn"><i class="ri-save-line align-bottom me-1"></i> Submit</button>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                    </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="card-animate card">
                                                    <div class="card-body">
                                                            <form method="post" id="in_count" action="{% url 'apps.main.vms:vms-submit' %}">
                                                                <input type="hidden" class="form-control" name="data_type" id="data_type" value="out" placeholder="">
                                                                <input type="hidden" class="form-control" name="template_id" id="template_id" value="{{ template_id }}" placeholder="">
                                                                <input type="hidden" class="form-control" name="visitor_record_id" id="visitor_record_id" value="{{ hcDefault.id }}" placeholder="">
                                                                <div class="d-flex justify-content-between">
                                                                    <div>
                                                                        <p class="fw-medium text-muted mb-0">Visitor Out</p>
                                                                        <div class="input-step full-width step-danger mt-4"><button type="button" class="minus material-shadow">–</button><input min="1" max="100" readonly="" type="number" name="visitor_count" class="product-quantity form-control form-control-lg" value="1"><button type="button" class="plus material-shadow">+</button></div>
                                                                    </div>
                                                                    <div>
                                                                        <div class="flex-shrink-0">
                                                                        <span class="badge bg-soft-danger text-danger fs-16"><i class="ri-arrow-down-s-line fs-17 align-middle me-1"></i>OUT</span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-auto mt-4">
                                                                    <div class="gap-1 flex-wrap">
                                                                        <button type="submit" class="btn btn-danger add-btn" data-bs-toggle="modal" id="db_submit_btn"><i class="ri-save-line align-bottom me-1"></i> Submit</button>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                    </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endif %}
                                    </div>


                                    <div class="col-5">
                                        <div class="row">
                                            <div class="col-12">
                                                {% if configData and configData.is_vms_enabled and configData.is_vms_matrix == False %}
                                                    <div class="card">
                                                        <div class="card-header d-flex align-items-center">
                                                            <h6 class="card-title mb-0 flex-grow-1">Today's Visit Logs</h6>
                                                            <a class="text-muted" href="{% url 'apps.main.vms:vms-records-list' hc_default_id=hcDefault.id %}">
                                                                See All <i class="ri-arrow-right-line align-bottom"></i>
                                                            </a>
                                                        </div>
                                                        <div class="card-body">
                                                            <div class="table-responsive table-card">
                                                                <div data-simplebar="init" style="height: 100%;" class="simplebar-scrollable-y"><div class="simplebar-wrapper" style="margin: 0px;"><div class="simplebar-height-auto-observer-wrapper"><div class="simplebar-height-auto-observer"></div></div><div class="simplebar-mask"><div class="simplebar-offset" style="right: 0px; bottom: 0px;"><div class="simplebar-content-wrapper" tabindex="0" role="region" aria-label="scrollable content" style="height: auto; overflow: hidden scroll;"><div class="simplebar-content" style="padding: 0px;">
                                                                    <ul class="list-group list-group-flush">
        
                                                                        {% for visitorData in visitorsData %}
        
                                                                            <li class="list-group-item list-group-item-action">
                                                                                <div class="d-flex align-items-center">
                                                                                    <div class="ms-3 flex-grow-1">
                                                                                        {% if visitorData.is_in == True %}
                                                                                            <span class="badge bg-soft-success text-success fs-12"><i class="ri-arrow-up-s-line fs-13 align-middle me-1"></i>IN</span>
                                                                                        {% else %}
                                                                                            <span class="badge bg-soft-danger text-danger fs-12"><i class="ri-arrow-down-s-line fs-13 align-middle me-1"></i>OUT</span>
                                                                                        {% endif %}
                                                                                        <span class="badge fs-12" style="color: var(--vz-body-color); font-weight: normal">Updated By - <strong>{{ visitorData.created_by.first_name }} {{ visitorData.created_by.last_name }}</strong></span>
                                                                                        <p class="mb-0 text-muted pt-1">{{ visitorData.updated_at|date:'h:i A, d-m-Y' }}</p>
                                                                                    </div>
                                                                                    <div>
                                                                                        <div class="flex-shrink-0 avatar-sm">
                                                                                            {% if visitorData.is_in == True %}
                                                                                                <span class="mini-stat-icon avatar-title rounded-circle text-success bg-soft-success fs-4">
                                                                                                    {{ visitorData.count }}
                                                                                                </span>
                                                                                            {% else %}
                                                                                                <span class="mini-stat-icon avatar-title rounded-circle text-danger bg-soft-danger fs-4">
                                                                                                    {{ visitorData.count }}
                                                                                                </span>
                                                                                            {% endif %}
                                                                                            
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </li>
        
                                                                        {% endfor %}
                                                                        
                                                                    </ul>
                                                                </div></div></div></div><div class="simplebar-placeholder" style="width: 328px; height: 445px;"></div></div><div class="simplebar-track simplebar-horizontal" style="visibility: hidden;"><div class="simplebar-scrollbar" style="width: 0px; display: none;"></div></div><div class="simplebar-track simplebar-vertical" style="visibility: visible;"><div class="simplebar-scrollbar" style="height: 299px; transform: translate3d(0px, 0px, 0px); display: block;"></div></div></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>



                                
                                


                                

                            </div> <!-- end .h-100-->

                        </div> <!-- end col -->

                    
                    </div>

                </div>
                <!-- container-fluid -->
            </div>
            <!-- End Page-content -->
            {% block footer %}
            {% include "partials/footer.html" %}
            {% endblock footer %}
        </div>
        <!-- end main content-->
{% endblock content %}

{% block extra_js %}

<!--Swiper slider js-->
<script src="{% static 'libs/swiper/swiper-bundle.min.js'%}"></script> 

<!-- input spin init -->
<script src="{% static 'libs/form-input-spin/form-input-spin.js' %}"></script>

{% endblock extra_js %}